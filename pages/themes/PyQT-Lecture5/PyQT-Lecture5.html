<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>PyQT-Lecture5</title>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

	<link rel="shortcut icon" type="image/jpg" href="/PythonCourseNetIT-Slides/favicon.png"/>

	<!-- css & themes include -->
	<link rel="stylesheet" href="/PythonCourseNetIT-Slides/lib/reveal.js/css/reveal.css">
	<link rel="stylesheet" href="/PythonCourseNetIT-Slides/outfit/css/themes/light.css" id="theme">
	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? '/PythonCourseNetIT-Slides/outfit/css/print.css' : '/PythonCourseNetIT-Slides/lib/reveal.js/css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>
	<!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
	<!-- CUSTOM -->
	<base target="_blank">
</head>
<body>
	<div class="reveal default center" data-transition-speed="default" data-background-transition="default">
		<div class="top_links">
			<a class="home_link" href="/PythonCourseNetIT-Slides/pages/agenda/agenda.html#DB-Lecture8" target="_top"></a>
			<span class="help_link"><i class="fa fa-question"></i></span>
			<div class="help_text">
				<div class="note">Keyboard shortcuts:</div>
				<div><span>N/Спейс</span><span>Next Slide</span></div>
				<div><span>P</span><span>Previous Slide</span></div>
				<div><span>O</span><span>Slides Overview</span></div>
				<div><span>ctrl+left click</span><span>Zoom Element</span></div>
				<div class="print-howto"><br>If you want print version => add '<code>?print-pdf</code>' <br> at the end of slides URL (remove '#' fragment) and then print. <br>
				Like: https://wwwcourses.github.io/...CourseIntro.html?print-pdf </div>
			</div>
		</div>
		<div class="footer theme_switch">
			<a href="#" onclick="document.getElementById('theme').setAttribute('href','/PythonCourseNetIT-Slides/outfit/css/themes/dark.css'); return false;">Dark</a>
			<a href="#" onclick="document.getElementById('theme').setAttribute('href','/PythonCourseNetIT-Slides/outfit/css/themes/light.css'); return false;">Light</a>
			<a href="#" onclick="document.getElementById('theme').setAttribute('href','/PythonCourseNetIT-Slides/outfit/css/themes/projector.css'); return false;">Projector</a>
		</div>
		<div class="slides">
<!--
########################################################
##################### SLIDES START #####################
########################################################
-->
<section class="main-section-title"><h1>PyQT - Lecture 5 : Hands On a Project with PyQT and Mysql</h1></section>
<section data-transition="zoom">
	<section class="copyright" data-transition="zoom">
		<div class="note">
			<p>Created for</p>
		</div>
		<div class="company">
			<a href="https://softwareacademy.bg/">
			<img style="height:80%" src="/PythonCourseNetIT-Slides/outfit/images/logos/software-web@4x.png" alt="software-web@4x.png">
			</a>
		</div>
		<div class="author">
			<span class="note"><a href="https://www.linkedin.com/in/ivapopova/">Iva E. Popova</a>, 2022-2023,</span>
			<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>
			<!-- <i class="fa fa-linkedin"></i> -->
		</div>
	</section>
</section>


<section data-min="5" class="main-section-title"><h1>Hands On a Project with PyQT and Mysql</h1></section>
<section class="sub-sections"><h2>Init Project</h2>
	<section id="createProjectSVirtualEnvironment"><h3>Create project's virtual environment</h3>
		<p>If you don't use PyCharm, or if you want to understand what's PyCharm is doing...:</p>
		<dl class="fa">
			<dt>Create the root project folder</dt>
			<pre><code rel="Terminal" class="bash">
				# make directory named "QTsimpleLoginForm":
				mkdir QTsimpleLoginForm

				# navigate to your root project folder:
				cd QTsimpleLoginForm
			</code></pre>
			<dt>Create a virtual environment and activate it:</dt>
			<pre><code rel="Terminal" class="bash" style="height: 30vh;">
				### create a virtualenv named ".venv" in current working folder:
				# on Linux/MacOS:
				python3 -m venv ./.venv
				#  on Windows (CMD):
				python -m venv ./.venv

				### activate the ".venv" environment:
				# on Linux/MacOS:
				source .venv/bin/activate
				#  on Windows (CMD):
				.\env\Scripts\activate

				# your command prompt should be prefixed with "(.venv)" now
			</code></pre>
			<dt>You can deactivate a virtual environment by typing “deactivate” in your shell.</dt>
			<dt>Reference: <a href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/#creating-a-virtual-environment">Creating a virtual environment @python.org</a></dt>
		</dl>
	</section>
	<section id="installPackages"><h3>Install packages needed for your project</h3>
		<pre><code rel="Terminal" class="bash">
			pip install mysql-connector-python
			pip install PyQt6
			pip install pyqt6-tools
			pip install configparser
		</code></pre>
	</section>
	<section id="freezingDependencies"><h3>Freezing dependencies</h3>
		<dl class="fa">
			<dt>When you want to share your project, you must provide <a href="https://pip.pypa.io/en/latest/user_guide/#requirements-files">Requirements File</a> which allows to re-create the exact versions of all packages installed in your environment.</dt>
			<dt>Pip can export a list of all installed packages and their versions using the freeze command</dt>
			<pre><code rel="Terminal" class="bash">
				# just list the installed packages
				pip freeze

				# save the list into "requirements.txt" file:
				pip freeze > requirements.txt
			</code></pre>
		</dl>
	</section>
	<section id="initGit"><h3>Init project git repo and add the project to Github</h3>
		<dl class="fa">
			<dt>Init your git repo</dt>
			<dt>Create <a href="https://git-scm.com/docs/gitignore">.gitignore</a> file and add in it files/folders to be ignored by git</dt>
			<dd>You can use next template for Python provided by GitHub: <a href="https://raw.githubusercontent.com/github/gitignore/master/Python.gitignore">Python.gitignore</a> :</dd>
			<dd>Make sure that you have <span class="note">uncomment</span> ignore sections related to your environment (like PyCharm's .idea).</dd>
			<dt>To add your project to GitHub, follow <a href="https://docs.github.com/en/get-started/importing-your-projects-to-github/importing-source-code-to-github/adding-locally-hosted-code-to-github#adding-a-local-repository-to-github-using-git">the github's instructions</a></dt>
		</dl>
	</section>
</section>

<section data-min="50" class="main-section-title" id="usingConfigFileForDbConnectionString"><h1>Using Config File For DB Connection String</h1></section>
<section class="sub-sections"><h2>Using Config File For DB Connection String</h2>
	<section>
		<dl class="fa">
			<dt>The DB connection string contains sensitive information. To prevent security vulnerabilities and maintenance problems we do not want to embed it in our application code, but rather to put that information in a separate config file.</dt>
			<dt>Create the application <code>config.ini</code> file using the example code bellow:</dt>
			<pre><code rel="config.ini" class="python">
				[mysql]
				HOST     = 127.0.0.1
				USER     = root
				PASSWORD = 1234
				DATABASE = customers_db
				PORT=3306
			</code></pre>
			<dt>In order to parse the <code>config.ini</code> file we can use the <a href="https://docs.python.org/3/library/configparser.html">configparser</a> module</dt>
			<pre><code rel="db_config.py" class="python">
				from configparser import ConfigParser


				def read_db_config(filename='config.ini', section='mysql'):
					""" Read database configuration file and return a dictionary object
						:param filename: name of the configuration file
						:param section: section of database configuration
						:return: a dictionary of database parameters
					"""
					# create parser and read the configuration file
					parser = ConfigParser()
					parser.read(filename)


					db_config = {}
					if parser.has_section(section):
						items = parser.items(section)
						for item in items:
							db_config[item[0]] = item[1]
					else:
						raise Exception(f'{section} not found in the {filename} file')

					return db_config

				db_config = read_db_config()
				print(db_config)
			</code></pre>
		</dl>
	</section>
</section>

<section data-min="5" class="main-section-title"><h1>Handling SQL Databases With PyQt</h1></section>
<section class="sub-sections"><h2>Handling SQL Databases With PyQt</h2>
	<section><h3>Connecting PyQt to an SQL Database</h3>
		<pre><code rel="Syntax" class="python">
			QSqlDatabase.addDatabase(
				driver, connectionName=QSqlDatabase.defaultConnection
			)
		</code></pre>
		<dl class="fa">
			<dt><span class="note">driver</span> - required argument that holds a string containing the name of a <a href="https://doc.qt.io/qt-5/sql-driver.html#supported-databases">PyQt-supported SQL driver</a></dt>
			<dd>Note, that <span class="note"><b>you must compile Qt with the specific driver</b>, except for built-in SQLite.</span></dd>
			<dt><span class="note">connectionName</span> - an optional argument that holds a string with the name of the connection</dt>
			<dt>Once you’ve created a connection, you might need to set several attributes on it. The specific set of attributes will depend on the driver you’re using. In general, you’ll need to set attributes such as the database name, the username, and the password for accessing the database</dt>
			<table class="table table-hover" style="font-size: .9em">
				<thead>
				<tr>
				<th>Method</th>
				<th>Description</th>
				</tr>
				</thead>
				<tbody>
				<tr>
				<td><code>.setDatabaseName(name)</code></td>
				<td>Sets the database name to <code>name</code>, which is a <a href="https://realpython.com/python-strings/">string</a> representing a valid database name</td>
				</tr>
				<tr>
				<td><code>.setHostName(host)</code></td>
				<td>Sets the hostname to <code>host</code>, which is a string representing a valid hostname</td>
				</tr>
				<tr>
				<td><code>.setUserName(username)</code></td>
				<td>Sets the username to <code>username</code>, which is a string representing a valid user name</td>
				</tr>
				<tr>
				<td><code>.setPassword(password)</code></td>
				<td>Sets the password to <code>password</code>, which is a string representing a valid password</td>
				</tr>
				</tbody>
			</table>
		</dl>
	</section>
	<section><h3>Example</h3>
		<pre><code rel="Python" class="python" style="min-height: 90vh;">
			from PyQt6.QtSql import QSqlDatabase, QSqlQuery, QSqlTableModel
			from PyQt6.QtWidgets import QTableView, QApplication
			import sys


			class DB:
				def __init__(self) -> None:
					self.conn()

				def conn(self):
					db = QSqlDatabase.addDatabase('QSQLITE')
					db.setDatabaseName('bnr.db')

					if not db.open():
						QtGui.QMessageBox.critical(None, QtGui.qApp.tr("Cannot open database"),
							QtGui.qApp.tr("Unable to establish a database connection.\n"),
							QtGui.QMessageBox.Cancel)

						return False

					self.query = QSqlQuery()
					return True

			if __name__ == '__main__':
				app = QApplication(sys.argv)
				db = DB()

		</code></pre>
	</section>
	<section><h3>Create Tables</h3>
		<pre><code rel="Python" class="python">
			def createTable(self):
				q = QSqlQuery()
				q.exec(f"""
					CREATE TABLE radiotheaters(
						id int primary key,
						title varchar(20),
						content varchar(100),
						date TEXT
					)
				""")
		</code></pre>
	</section>
	<section><h3>Executing Dynamic Queries with Placeholder Parameters</h3>
		<dl class="fa">
			<dt>PyQt supports two parameter placeholder styles:</dt>
			<dd>Oracle style uses named placeholders such as :name or :address.</dd>
			<dd>ODBC style uses a question mark (?) as a positional placeholder.</dd>
			<dt>To create this kind of dynamic query in PyQt, you first create a template with a placeholder for each query parameter and then pass that template as an argument to <code>.prepare()</code>, which parses, compiles, and prepares the query template for execution</dt>
			<dt>If the preparation process succeeds, then <code>prepare()</code> returns True. After that, you can pass a specific value to each parameter using <code>.bindValue()</code> with named or positional parameters or using <code>.addBindValue()</code> with positional parameters.</dt>
			<dt>.bindValue() has the following two variations:</dt>
			<dd><code>.bindValue(placeholder, val)</code></dd>
			<dd><code>.bindValue(pos, val)</code></dd>
		</dl>
	</section>
	<section><h3>Example</h3>
		<pre><code rel="Python" class="python" style="min-height: 90vh;">
			def insertRow(self, **kwargs):
				# Creating a query for later execution using .prepare()
				q = QSqlQuery()
				q.exec()
				q.prepare(
							"""
							INSERT INTO radiotheaters (
											title,
											content,
											date
							)
							VALUES (?, ?, ?)
							"""
				)

				q.addBindValue(kwargs['title'])
				q.addBindValue(kwargs['content'])
				q.addBindValue(kwargs['date'])
				q.exec()


			if __name__ == '__main__':
				app = QApplication(sys.argv)
				db = DB()

				# Sample data
				data = [
					("Theater1", "Content1", "2021-01-01"),
					("Theater2", "Content2", "2021-01-02"),
					("Theater3", "Content3", "2021-01-03"),
					("Theater4", "Content4", "2021-01-04"),
				]

				for title, content, date in data:
					db.insertRow(title=title, content=content, date=date)
		</code></pre>

	</section>
</section>

<!--
<section data-min="5" class="main-section-title"><h1>Add GUI feature to your app</h1></section>
<section class="sub-sections"><h2>Add GUI feature to your app</h2>
	<section><h3>Create/Clone repos</h3>
		<dl class="fa">
			<dt>Create your github repo, or clone someone's else (if you want to contribute to the project)</dt>
			<dt>References:</dt>
			<dd><a href="https://docs.github.com/en/get-started/quickstart/create-a-repo">Create a repo @docs.github.com</a></dd>
			<dd><a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository">Cloning a repository @docs.github.com</a></dd>
		</dl>
	</section>
	<section><h3>Create a branch for <code>GUI</code> of your app</h3>
		<dl class="fa">
			<dt>If you already have a working application with console IO, and you want to refactor your app to work with GUI, it's best to separate your work in a different branch.</dt>
			<pre><code rel="Terminal" class="bash">
				# make sure you're in root project folder, and type:
				git checkout -b GUI

				# your prompt should change and show the branch name (GUI)
			</code></pre>
			<dd><a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell">Git branching branches in a nutshell</a> </dd>
			<dd><a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow">Git Feature Branch Workflow @atlassian.com</a></dd>
		</dl>
	</section>
</section> -->


<section data-min="5" class="main-section-title"><h1>Add GUI feature to your app as separate git branch (extra topic)</h1></section>
<section class="sub-sections"><h2>Add GUI feature to your app as separate git branch</h2>
	<!-- <section><h3>Create/Clone repos</h3>
		<dl class="fa">
			<dt>Create your github repo, or clone someone's else (if you want to contribute to the project)</dt>
			<dt>References:</dt>
			<dd><a href="https://docs.github.com/en/get-started/quickstart/create-a-repo">Create a repo @docs.github.com</a></dd>
			<dd><a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository-from-github/cloning-a-repository">Cloning a repository @docs.github.com</a></dd>
		</dl>
	</section> -->
	<section><h3>Disclaimer</h3>
		<dl class="fa">
			<dt>Note, that topics on Git/GitHub will not be included in final exam! But they will speed your workflow process, especially on final course project development!</dt>
		</dl>
	</section>
	<section><h3>Git Branch Overview</h3>
		<dl class="fa">
			<dt>If you already have a working application with console IO, and you want to refactor your app to work with GUI, it's best to separate your work in a different branch.</dt>
			<dt>Readings:</dt>
			<dd><a href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell">Git branching branches in a nutshell</a> </dd>
			<dd><a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow">Git Feature Branch Workflow @atlassian.com</a></dd>
		</dl>
	</section>
	<section><h3>Git Branch Overview - Video</h3>
		<p><a href="https://www.youtube.com/watch?v=QV0kVNvkMxc">Git & GitHub Tutorial for Beginners #8 - Branches</a></p>
		<iframe width="912" height="513" src="https://www.youtube.com/embed/QV0kVNvkMxc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
	</section>
	<section><h3>Create and work in a branch for <code>GUI</code> of your app</h3>

		<pre><code rel="Terminal" class="bash" style="min-height: 80vh;">
			### make sure you're in the git project folder and that you git status is clear:
			git status
			#On branch main
			#nothing to commit, working tree clean

			### create new branch, named "GUI"
			git checkout -b GUI
			# your prompt should change and show the branch name (GUI)

			# do some hard work on your GUI app...

			# commit your work:
			git add -A
			git commit -m'hard work done'

			### switching between branches
			# go back to you main branch
			git checkout main
			# this command will return you to the main branch

			# do some stuff on main, but remember - to commit

			# swithch back to GUI branch:
			git checkout GUI
		</code></pre>
	</section>
</section>

<section class="disclaimer end-slide"></section>
<!--
########################################################
##################### SLIDES END   #####################
########################################################
-->
		</div>
	</div>
	<!-- Custom processing -->
	<script src="/PythonCourseNetIT-Slides/outfit/js/slides.js"></script>
	<!-- external scripts -->
	<script src="/PythonCourseNetIT-Slides/lib/reveal.js/lib/js/head.min.js"></script>
	<script src="/PythonCourseNetIT-Slides/lib/reveal.js/js/reveal.js"></script>
	 <!-- init reveal -->
	<script>
		// Full list of configuration options available at:
		// https://github.com/hakimel/reveal.js#configuration
		var highlightjsTabSize = '  ';
		Reveal.initialize({
			controls: true,
			progress: true,
			slideNumber: 'c/t',
			keyboard: true,
			history: true,
			center: true,
			width: 1920,
			height: 1280,
			// Bounds for smallest/largest possible scale to apply to content
			// minScale: .5,
			maxScale: 1,
			// slide transition
			transition: 'concave', // none/fade/slide/convex/concave/zoom
			// Factor of the display size that should remain empty around the content
			margin: 0.1,
			// shift+left click to zoom in/out element
			zoomKey: 'ctrl',
			// theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
			// transition: Reveal.getQueryHash().transition || 'default'
			// Optional reveal.js plugins
			dependencies: [
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.configure({tabReplace: highlightjsTabSize}); hljs.initHighlightingOnLoad(); } },
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/plugin/zoom-js/zoom.js', async: true },
				{ src: '/PythonCourseNetIT-Slides/lib/reveal.js/plugin/notes/notes.js', async: true }
			]
		});
	</script>
</body>
</html>
